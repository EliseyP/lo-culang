# Onik 

**1.1.29**

Libre Office расширение для текстов с церковно-славянским языком.  

**В консольном и графическом вариантах:**
<ul>
<li>Переводит текст с различными Orthodox [UCS] шрифтами в Ponomar Unicode.</li>  
<li>Переводит текст из современной (или смешанной) орфографии в церковно-славянскую (некоторые буквы, ударения, титла (выставить и раскрыть) и т.д.).</li>
<li>Меняет ударение в слове (оксия, вария, камора, исо, апостроф).</li>  
<li>Преобразует числа в буквы</li>
<li>Меняет буквы  <strong>о, е</strong> <i>(о, омега, е, е-широкое, ять)</i>  в начале и конце слова. </li>
</ul>

**Для установки**  

Для Linux требуется установить компонент LibreOffice: *libreoffice-script-provider-python*  
``$ sudo apt-get install libreoffice-script-provider-python``  

**После установки**  

В OOffice конвертеры доступны через собственные меню и панель.

Из командной строки (например, для пакетной обработки) **ucs конвертер** может быть запущен подобным образом (необходимо указать полный путь к файлу):  
``$ soffice --invisible "macro:///OOnik.main.run_ucs_convert_py($PWD/$file_name.odt)"``  

Обрабатывается либо выделенный текст, либо весь открытый документ.

Для тестов или скриптов м.б. использваны py-скрипт:   
``$ onik_run.py 'Фома'``  
``Ѳѡма̀``     
и текстовый фильтр:   
``$ echo 'Фома' |  onik_test.py``  
``Ѳѡма̀``  



### Orthodox шрифты, доступные для конвертации :  
<ul> 
<li>Hirmos Ponomar TT</li>
<li>Hirmos Ucs</li>
<li>Irmologion</li>
<li>Irmologion Ucs</li>
<li>Orthodox</li>
<li>OrthodoxDigits</li>
<li>OrthodoxDigitsLoose</li>
<li>OrthodoxLoose</li>
<li>Orthodox.tt eRoos</li>
<li>Orthodox.tt ieERoos</li>
<li>Orthodox.tt ieUcs8</li>
<li>Orthodox.tt ieUcs8 Caps</li>
<li>Orthodox.tt Ucs8</li>
<li>Orthodox.tt Ucs8 Caps</li>
<li>Orthodox.tt Ucs8 Caps tight</li>
<li>Orthodox.tt Ucs8 tight</li>
<li>Triodion ieUcs</li>
<li>Triodion Ucs</li>
<li>Ustav</li>
<li>Valaam</li>
</ul>  


Конвертеры написаны для обработки большого количества документов, в которых церковно-славянские тексты набраны самыми различными (см. выше) ЦСЯ-шрифтами, и оформлены (орфографически) самыми разными способами.  

Расширение продолжает идею:
https://extensions.libreoffice.org/extensions/church-slavonic-converter

### Работа с инструментами  

#### Конвертация шрифтов

На панели доступна кнопка для автоматической конвертации,   
![Кнопка конвертации](/src/OOnik/Images/nYat_16.png)  
 и конвертации с опциями (на данный момент показыает список шрифтов, и конвертирует в автоматическом режиме)   
![Кнопка конвертации](/src/OOnik/Images/nYat_red_16.png)  

**Остальные кнопки - обработка текста со шрифтом Ponomar:**

Перевод текста в современной орфографии в цся (с титлами и без).  
![Русский -> ЦСЯ](/src/OOnik/Images/nAz_16.png)  ![Русский -> ЦСЯ (с титлами)](/src/OOnik/Images/nAz_titled_16.png)  

Раскрыть титла (в выделенном фрагменте)  
![Русский -> ЦСЯ (раскрыть титла)](/src/OOnik/Images/nTitles_open_16.png)  

Числа в буквы  
![Числа в буквы](/src/OOnik/Images/Digits_16.png)  

Изменить ударение в слове под курсором (циклически меняется оксия, вария, камора. Учитываются **е** и **о**)  
![Изменить ударение](/src/OOnik/Images/Acutes_16.png)  

Изменение вида букв **о** в начале слова, а также  **е** и **о** в конце.  
![Буква О в начале слова](/src/OOnik/Images/ChLetStart_16.png) 
![Буква О в конце слова](/src/OOnik/Images/ChLetEndO_16.png) 
![Буква Е в конце слова](/src/OOnik/Images/ChLetEndE_16.png)  

### Проблемы:  

#### При конвертации шрифтов:
- Иногда требуется два прохода.  
- При работе с цветом и более сложным форматированием возможно придется либо убрать форматирование, либо обрабатывать только выделенные фрагменты.

#### При обработке текста:
- Текст обрабатывается регулярными выражениями, которые могут совершать разного рода неточности и ошибки. Поэтому после обработки возможны неверные ударения.    

#### Общие:
- нет обработки текста в таблице (todo).
